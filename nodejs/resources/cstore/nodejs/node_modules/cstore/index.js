'use strict';
const shell = require('shelljs');

function pull(opts) {
  
    let cmd = '/opt/nodejs/node_modules/cstore/cstore64 pull -l'
    
    if (opts){ 
        if (opts.tags) {
            cmd += ' -t "' + opts.tags.join("&") + '"'
        } 
    
        if (opts.format) {
            cmd += " -g " + opts.format
        } 

        if (opts.inject) {
            cmd += " -i"
        } 

        if (opts.args) {
            cmd += " " + args
        }
    }

    // silent:true prevents output from being logged compromising secrets
    var result = shell.exec(cmd, {silent:true})

    if (result.code != 0) {
        throw new Error(result.stderr)
    }

    return JSON.parse(result.stdout)
}

module.exports.pull = pull;